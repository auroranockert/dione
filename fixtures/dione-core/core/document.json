{
   "_id": "_design/dione",
   "language": "javascript",
   "views": {
       "routes": {
           "map": "function (doc) {\n  if (doc.urls) {\n    for (var i = 0; i < doc.urls.length; i++) {\n      var url = doc.urls[i]\n\n      if (doc.public !== false) {\n        emit(url, [doc._id])\n      }\n\n      if (doc._attachments) {\n        var keys = Object.keys(doc._attachments)\n\n        for (var j = 0; j < keys.length; j++) {\n          var key = keys[j]\n          var public = doc.public !== false\n\n          if (doc.attachments) {\n            if (doc.attachments[key]) {\n              if (doc.attachments[key].public !== null) {\n                public = doc.attachments[key].public\n              }\n            }\n          }\n\n          if (public) {\n            emit(url + \"/\" + key, [doc._id, key])\n          }\n        }\n      }\n    }\n  }\n}"
       }
   }
}